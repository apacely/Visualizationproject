<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Dataset Visualization</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f9f9f9;
        }
        svg {
            border: 1px solid #ccc;
        }
        .tooltip {
            position: absolute;
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 5px;
            border-radius: 3px;
            font-size: 12px;
            pointer-events: none;
            box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);
        }
        .controls {
            margin-bottom: 20px;
        }
        .controls label {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>Interactive Dataset Visualization</h1>
    <div class="controls">
        <label for="filter">Filter by Dataset Version:</label>
        <select id="filter">
            <option value="all">All</option>
        </select>
    </div>
    <svg width="800" height="400"></svg>
    <div class="tooltip" style="display: none;"></div>

    <script>
        const dataset = [
            { Drug_Name: "XMD11-85h", Dataset_Version: "GDSC1", Epoch: 1, Predictive_Accuracy: 85 },
            { Drug_Name: "SN-38", Dataset_Version: "GDSC2", Epoch: 2, Predictive_Accuracy: 70 },
            { Drug_Name: "AZD5991", Dataset_Version: "GDSC2", Epoch: 3, Predictive_Accuracy: 60 },
            { Drug_Name: "AZD7969", Dataset_Version: "GDSC1", Epoch: 4, Predictive_Accuracy: 90 },
            { Drug_Name: "150412", Dataset_Version: "GDSC2", Epoch: 5, Predictive_Accuracy: 50 }
        ];

        const margin = { top: 20, right: 30, bottom: 40, left: 50 };
        const width = 800 - margin.left - margin.right;
        const height = 400 - margin.top - margin.bottom;

        const svg = d3.select("svg")
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const xScale = d3.scaleBand()
            .domain(dataset.map(d => d.Drug_Name))
            .range([0, width])
            .padding(0.2);

        const yScale = d3.scaleLinear()
            .domain([0, 100])
            .nice()
            .range([height, 0]);

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(xScale));

        svg.append("g")
            .call(d3.axisLeft(yScale));

        const tooltip = d3.select(".tooltip");

        const bars = svg.selectAll("rect")
            .data(dataset)
            .enter()
            .append("rect")
            .attr("x", d => xScale(d.Drug_Name))
            .attr("y", d => yScale(d.Predictive_Accuracy))
            .attr("width", xScale.bandwidth())
            .attr("height", d => height - yScale(d.Predictive_Accuracy))
            .attr("fill", "steelblue")
            .on("mouseover", (event, d) => {
                tooltip.style("display", "block")
                    .style("left", `${event.pageX + 5}px`)
                    .style("top", `${event.pageY - 28}px`)
                    .html(`<strong>Drug:</strong> ${d.Drug_Name}<br><strong>Accuracy:</strong> ${d.Predictive_Accuracy}%`);
            })
            .on("mouseout", () => tooltip.style("display", "none"));

        const filterMenu = d3.select("#filter");

        const versions = Array.from(new Set(dataset.map(d => d.Dataset_Version)));
        versions.forEach(version => {
            filterMenu.append("option")
                .attr("value", version)
                .text(version);
        });

        filterMenu.on("change", function() {
            const selected = this.value;
            const filteredData = selected === "all" ? dataset : dataset.filter(d => d.Dataset_Version === selected);

            const updatedBars = svg.selectAll("rect")
                .data(filteredData, d => d.Drug_Name);

            updatedBars.enter()
                .append("rect")
                .attr("x", d => xScale(d.Drug_Name))
                .attr("y", d => yScale(d.Predictive_Accuracy))
                .attr("width", xScale.bandwidth())
                .attr("height", d => height - yScale(d.Predictive_Accuracy))
                .attr("fill", "steelblue")
                .merge(updatedBars)
                .transition()
                .duration(500)
                .attr("x", d => xScale(d.Drug_Name))
                .attr("y", d => yScale(d.Predictive_Accuracy))
                .attr("height", d => height - yScale(d.Predictive_Accuracy));

            updatedBars.exit().remove();
        });
    </script>
    <p><a href="Documentation.html">Documentation Page</a> | <a href="Demonstration.html">Demonstration Page</a></p>
</body>
</html>
